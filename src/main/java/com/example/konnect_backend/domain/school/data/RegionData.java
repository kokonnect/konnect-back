package com.example.konnect_backend.domain.school.data;

import com.example.konnect_backend.domain.school.dto.response.RegionResponse;

import java.util.*;

/**
 * 시도/시군구 코드 데이터
 * - 학교알리미 API에서 사용하는 지역 코드
 */
public class RegionData {

    /**
     * 시도 코드 목록
     */
    public static final Map<String, String> SIDO_MAP = new LinkedHashMap<>() {{
        put("11", "서울특별시");
        put("26", "부산광역시");
        put("27", "대구광역시");
        put("28", "인천광역시");
        put("29", "광주광역시");
        put("30", "대전광역시");
        put("31", "울산광역시");
        put("36", "세종특별자치시");
        put("41", "경기도");
        put("43", "충청북도");
        put("44", "충청남도");
        put("46", "전라남도");
        put("47", "경상북도");
        put("48", "경상남도");
        put("50", "제주특별자치도");
        put("51", "강원특별자치도");
        put("52", "전북특별자치도");
    }};

    /**
     * 시군구 코드 목록 (시도코드 → 시군구 목록)
     */
    public static final Map<String, Map<String, String>> SGG_MAP = new LinkedHashMap<>();

    static {
        // 서울특별시
        SGG_MAP.put("11", new LinkedHashMap<>() {{
            put("11110", "종로구");
            put("11140", "중구");
            put("11170", "용산구");
            put("11200", "성동구");
            put("11215", "광진구");
            put("11230", "동대문구");
            put("11260", "중랑구");
            put("11290", "성북구");
            put("11305", "강북구");
            put("11320", "도봉구");
            put("11350", "노원구");
            put("11380", "은평구");
            put("11410", "서대문구");
            put("11440", "마포구");
            put("11470", "양천구");
            put("11500", "강서구");
            put("11530", "구로구");
            put("11545", "금천구");
            put("11560", "영등포구");
            put("11590", "동작구");
            put("11620", "관악구");
            put("11650", "서초구");
            put("11680", "강남구");
            put("11710", "송파구");
            put("11740", "강동구");
        }});

        // 부산광역시
        SGG_MAP.put("26", new LinkedHashMap<>() {{
            put("26110", "중구");
            put("26140", "서구");
            put("26170", "동구");
            put("26200", "영도구");
            put("26230", "부산진구");
            put("26260", "동래구");
            put("26290", "남구");
            put("26320", "북구");
            put("26350", "해운대구");
            put("26380", "사하구");
            put("26410", "금정구");
            put("26440", "강서구");
            put("26470", "연제구");
            put("26500", "수영구");
            put("26530", "사상구");
            put("26710", "기장군");
        }});

        // 대구광역시
        SGG_MAP.put("27", new LinkedHashMap<>() {{
            put("27110", "중구");
            put("27140", "동구");
            put("27170", "서구");
            put("27200", "남구");
            put("27230", "북구");
            put("27260", "수성구");
            put("27290", "달서구");
            put("27710", "달성군");
            put("27720", "군위군");
        }});

        // 인천광역시
        SGG_MAP.put("28", new LinkedHashMap<>() {{
            put("28110", "중구");
            put("28140", "동구");
            put("28177", "미추홀구");
            put("28185", "연수구");
            put("28200", "남동구");
            put("28237", "부평구");
            put("28245", "계양구");
            put("28260", "서구");
            put("28710", "강화군");
            put("28720", "옹진군");
        }});

        // 광주광역시
        SGG_MAP.put("29", new LinkedHashMap<>() {{
            put("29110", "동구");
            put("29140", "서구");
            put("29155", "남구");
            put("29170", "북구");
            put("29200", "광산구");
        }});

        // 대전광역시
        SGG_MAP.put("30", new LinkedHashMap<>() {{
            put("30110", "동구");
            put("30140", "중구");
            put("30170", "서구");
            put("30200", "유성구");
            put("30230", "대덕구");
        }});

        // 울산광역시
        SGG_MAP.put("31", new LinkedHashMap<>() {{
            put("31110", "중구");
            put("31140", "남구");
            put("31170", "동구");
            put("31200", "북구");
            put("31710", "울주군");
        }});

        // 세종특별자치시
        SGG_MAP.put("36", new LinkedHashMap<>() {{
            put("36110", "세종특별자치시");
        }});

        // 경기도
        SGG_MAP.put("41", new LinkedHashMap<>() {{
            put("41110", "수원시");
            put("41111", "수원시 장안구");
            put("41113", "수원시 권선구");
            put("41115", "수원시 팔달구");
            put("41117", "수원시 영통구");
            put("41130", "성남시");
            put("41131", "성남시 수정구");
            put("41133", "성남시 중원구");
            put("41135", "성남시 분당구");
            put("41150", "의정부시");
            put("41170", "안양시");
            put("41171", "안양시 만안구");
            put("41173", "안양시 동안구");
            put("41190", "부천시");
            put("41192", "부천시 원미구");
            put("41194", "부천시 소사구");
            put("41196", "부천시 오정구");
            put("41210", "광명시");
            put("41220", "평택시");
            put("41250", "동두천시");
            put("41271", "안산시 상록구");
            put("41273", "안산시 단원구");
            put("41281", "고양시 덕양구");
            put("41285", "고양시 일산동구");
            put("41287", "고양시 일산서구");
            put("41290", "과천시");
            put("41310", "구리시");
            put("41360", "남양주시");
            put("41370", "오산시");
            put("41390", "시흥시");
            put("41410", "군포시");
            put("41430", "의왕시");
            put("41450", "하남시");
            put("41461", "용인시 처인구");
            put("41463", "용인시 기흥구");
            put("41465", "용인시 수지구");
            put("41480", "파주시");
            put("41500", "이천시");
            put("41550", "안성시");
            put("41570", "김포시");
            put("41590", "화성시");
            put("41610", "광주시");
            put("41630", "양주시");
            put("41650", "포천시");
            put("41670", "여주시");
            put("41800", "연천군");
            put("41820", "가평군");
            put("41830", "양평군");
        }});

        // 충청북도
        SGG_MAP.put("43", new LinkedHashMap<>() {{
            put("43111", "청주시 상당구");
            put("43112", "청주시 서원구");
            put("43113", "청주시 흥덕구");
            put("43114", "청주시 청원구");
            put("43130", "충주시");
            put("43150", "제천시");
            put("43720", "보은군");
            put("43730", "옥천군");
            put("43740", "영동군");
            put("43745", "증평군");
            put("43750", "진천군");
            put("43760", "괴산군");
            put("43770", "음성군");
            put("43800", "단양군");
        }});

        // 충청남도
        SGG_MAP.put("44", new LinkedHashMap<>() {{
            put("44131", "천안시 동남구");
            put("44133", "천안시 서북구");
            put("44150", "공주시");
            put("44180", "보령시");
            put("44200", "아산시");
            put("44210", "서산시");
            put("44230", "논산시");
            put("44250", "계룡시");
            put("44270", "당진시");
            put("44710", "금산군");
            put("44760", "부여군");
            put("44770", "서천군");
            put("44790", "청양군");
            put("44800", "홍성군");
            put("44810", "예산군");
            put("44825", "태안군");
        }});

        // 전라남도
        SGG_MAP.put("46", new LinkedHashMap<>() {{
            put("46110", "목포시");
            put("46130", "여수시");
            put("46150", "순천시");
            put("46170", "나주시");
            put("46230", "광양시");
            put("46710", "담양군");
            put("46720", "곡성군");
            put("46730", "구례군");
            put("46770", "고흥군");
            put("46780", "보성군");
            put("46790", "화순군");
            put("46800", "장흥군");
            put("46810", "강진군");
            put("46820", "해남군");
            put("46830", "영암군");
            put("46840", "무안군");
            put("46860", "함평군");
            put("46870", "영광군");
            put("46880", "장성군");
            put("46890", "완도군");
            put("46900", "진도군");
            put("46910", "신안군");
        }});

        // 경상북도
        SGG_MAP.put("47", new LinkedHashMap<>() {{
            put("47110", "포항시");
            put("47111", "포항시 남구");
            put("47113", "포항시 북구");
            put("47130", "경주시");
            put("47150", "김천시");
            put("47170", "안동시");
            put("47190", "구미시");
            put("47210", "영주시");
            put("47230", "영천시");
            put("47250", "상주시");
            put("47280", "문경시");
            put("47290", "경산시");
            put("47730", "의성군");
            put("47750", "청송군");
            put("47760", "영양군");
            put("47770", "영덕군");
            put("47820", "청도군");
            put("47830", "고령군");
            put("47840", "성주군");
            put("47850", "칠곡군");
            put("47900", "예천군");
            put("47920", "봉화군");
            put("47930", "울진군");
            put("47940", "울릉군");
        }});

        // 경상남도
        SGG_MAP.put("48", new LinkedHashMap<>() {{
            put("48120", "창원시");
            put("48121", "창원시 의창구");
            put("48123", "창원시 성산구");
            put("48125", "창원시 마산합포구");
            put("48127", "창원시 마산회원구");
            put("48129", "창원시 진해구");
            put("48170", "진주시");
            put("48220", "통영시");
            put("48240", "사천시");
            put("48250", "김해시");
            put("48270", "밀양시");
            put("48310", "거제시");
            put("48330", "양산시");
            put("48720", "의령군");
            put("48730", "함안군");
            put("48740", "창녕군");
            put("48820", "고성군");
            put("48840", "남해군");
            put("48850", "하동군");
            put("48860", "산청군");
            put("48870", "함양군");
            put("48880", "거창군");
            put("48890", "합천군");
        }});

        // 제주특별자치도
        SGG_MAP.put("50", new LinkedHashMap<>() {{
            put("50110", "제주시");
            put("50130", "서귀포시");
        }});

        // 강원특별자치도
        SGG_MAP.put("51", new LinkedHashMap<>() {{
            put("51110", "춘천시");
            put("51130", "원주시");
            put("51150", "강릉시");
            put("51170", "동해시");
            put("51190", "태백시");
            put("51210", "속초시");
            put("51230", "삼척시");
            put("51720", "홍천군");
            put("51730", "횡성군");
            put("51750", "영월군");
            put("51760", "평창군");
            put("51770", "정선군");
            put("51780", "철원군");
            put("51790", "화천군");
            put("51800", "양구군");
            put("51810", "인제군");
            put("51820", "고성군");
            put("51830", "양양군");
        }});

        // 전북특별자치도
        SGG_MAP.put("52", new LinkedHashMap<>() {{
            put("52111", "전주시 완산구");
            put("52113", "전주시 덕진구");
            put("52130", "군산시");
            put("52140", "익산시");
            put("52180", "정읍시");
            put("52190", "남원시");
            put("52210", "김제시");
            put("52710", "완주군");
            put("52720", "진안군");
            put("52730", "무주군");
            put("52740", "장수군");
            put("52750", "임실군");
            put("52770", "순창군");
            put("52790", "고창군");
            put("52800", "부안군");
        }});
    }

    /**
     * 시도 목록 조회
     */
    public static List<RegionResponse> getSidoList() {
        List<RegionResponse> list = new ArrayList<>();
        SIDO_MAP.forEach((code, name) -> list.add(RegionResponse.of(code, name)));
        return list;
    }

    /**
     * 특정 시도의 시군구 목록 조회
     */
    public static List<RegionResponse> getSggList(String sidoCode) {
        List<RegionResponse> list = new ArrayList<>();
        Map<String, String> sggMap = SGG_MAP.get(sidoCode);
        if (sggMap != null) {
            sggMap.forEach((code, name) -> list.add(RegionResponse.of(code, name)));
        }
        return list;
    }

    /**
     * 시도 코드로 시도명 조회
     */
    public static String getSidoName(String sidoCode) {
        return SIDO_MAP.getOrDefault(sidoCode, "");
    }

    /**
     * 시군구 코드로 시군구명 조회
     */
    public static String getSggName(String sidoCode, String sggCode) {
        Map<String, String> sggMap = SGG_MAP.get(sidoCode);
        if (sggMap != null) {
            return sggMap.getOrDefault(sggCode, "");
        }
        return "";
    }
}
